#!/usr/bin/env bash

# add a word to the dictionary, optionally with prefix / suffix tags

# usage:
# ~ $ add word[/TAGS]

# remove any dictionary tags from the end i.e. rhywedd/M becomes rhywedd
gair=$(sed -e "s|/.*||" <<< "$1")
anhysbys=$(hunspell -L -d dictionaries/cy_GB <<< "$gair")

if [[ -n "$anhysbys" ]] ; then
	echo "Adding word \"$gair\" to dictionary"
	# Add word
	echo "$gair" >> dictionaries/word_list.txt
	echo "$1" >> dictionaries/cy_GB.dic
	# Write number of lines to tmp
	tail -n +2 dictionaries/cy_GB.dic | sort -u | wc -l > dictionaries/dict.tmp
	# Write sorted words to tmp
	tail -n +2 dictionaries/cy_GB.dic | sort -u >> dictionaries/dict.tmp
	# Copy tmp back to mwy.dic
	mv dictionaries/dict.tmp dictionaries/cy_GB.dic
	echo "Added word."
else
	echo "\"$gair\" is already in dictionary"
fi

# contains any unknown words in the word list
anhysbys=$(hunspell -L -d dictionaries/cy_GB dictionaries/word_list.txt)
if [[ -n "$anhysbys" ]] ; then
	echo "The dictionary does not recognise the following:"
	echo "$anhysbys"
else
	#echo "The dictionary recognises everything in the word list."
	echo ""
fi
